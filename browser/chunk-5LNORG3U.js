import{a as C,b as d,c as _,d as R,g as M,i as P,j as k,q as L,s as N}from"./chunk-RDPPS4E7.js";import{a as q}from"./chunk-DFZIMTXV.js";import{Aa as I,Ba as F,C as p,I as l,J as a,K as n,L as u,N as y,O as c,T as g,V as s,X as m,o as v,qa as b,sa as w,v as r,wa as E,x as f,xa as S,y as h}from"./chunk-CPYGXC5A.js";import"./chunk-LJ5XHLMQ.js";import{h as x}from"./chunk-FK42CRUA.js";function j(i,o){if(i&1&&(a(0,"p",19),s(1),n()),i&2){let t=c();r(),m(" ",t.getFieldError("username")," ")}}function V(i,o){if(i&1&&(a(0,"p",19),s(1),n()),i&2){let t=c();r(),m(" ",t.getFieldError("email")," ")}}function z(i,o){if(i&1&&(a(0,"p",19),s(1),n()),i&2){let t=c();r(),m(" ",t.getFieldError("password")," ")}}function B(i,o){if(i&1&&(a(0,"p",19),s(1),n()),i&2){let t=c();r(),m(" ",t.getFieldError("confirmPassword")," ")}}function D(i,o){if(i&1&&(a(0,"div",20),s(1),n()),i&2){let t=c();r(),m(" ",t.errorMessage," ")}}function A(i,o){i&1&&(a(0,"span",21),v(),a(1,"svg",22),u(2,"circle",23)(3,"path",24),n()())}var G=class i{constructor(o,t,e,T){this.fb=o;this.supabaseService=t;this.router=e;this.i18n=T;this.registerForm=this.fb.group({username:["",[d.required,d.minLength(3)]],email:["",[d.required,d.email]],password:["",[d.required,d.minLength(6)]],confirmPassword:["",[d.required]]},{validators:this.passwordMatchValidator})}registerForm;isLoading=!1;errorMessage="";passwordMatchValidator(o){let t=o.get("password"),e=o.get("confirmPassword");return t&&e&&t.value!==e.value?e.setErrors({passwordMismatch:!0}):e?.errors?.passwordMismatch&&(delete e.errors.passwordMismatch,Object.keys(e.errors).length===0&&e.setErrors(null)),null}onSubmit(){return x(this,null,function*(){if(this.registerForm.valid&&!this.isLoading){this.isLoading=!0,this.errorMessage="";try{let{username:o,email:t,password:e}=this.registerForm.value;yield this.supabaseService.signUp(t,e,o),this.router.navigate(["/auth/login"])}catch(o){this.errorMessage=this.i18n.t("auth.registerError"),console.error("Register error:",o)}finally{this.isLoading=!1}}})}getFieldError(o){let t=this.registerForm.get(o);if(t?.errors&&t.touched){if(t.errors.required)switch(o){case"username":return this.i18n.t("auth.usernameRequired");case"email":return this.i18n.t("auth.invalidEmail");case"password":return this.i18n.t("auth.passwordRequired");case"confirmPassword":return this.i18n.t("auth.passwordRequired");default:return""}if(t.errors.email)return this.i18n.t("auth.invalidEmail");if(t.errors.minlength)return o==="username"?this.i18n.t("auth.usernameRequired"):this.i18n.t("auth.passwordRequired");if(t.errors.passwordMismatch)return this.i18n.t("auth.passwordsNotMatch")}return""}static \u0275fac=function(t){return new(t||i)(f(L),f(F),f(E),f(q))};static \u0275cmp=h({type:i,selectors:[["app-register"]],decls:36,vars:24,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gray-50","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8"],[1,"mt-6","text-center","text-3xl","font-extrabold","text-gray-900"],[1,"mt-2","text-center","text-sm","text-gray-600"],["routerLink","/auth/login",1,"font-medium","text-primary-600","hover:text-primary-500"],[1,"mt-8","space-y-6",3,"ngSubmit","formGroup"],[1,"space-y-4"],["for","username",1,"block","text-sm","font-medium","text-gray-700"],["id","username","name","username","type","text","formControlName","username",1,"mt-1","appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-primary-500","focus:border-primary-500","focus:z-10","sm:text-sm"],["class","mt-1 text-sm text-red-600",4,"ngIf"],["for","email",1,"block","text-sm","font-medium","text-gray-700"],["id","email","name","email","type","email","formControlName","email",1,"mt-1","appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-primary-500","focus:border-primary-500","focus:z-10","sm:text-sm"],["for","password",1,"block","text-sm","font-medium","text-gray-700"],["id","password","name","password","type","password","formControlName","password",1,"mt-1","appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-primary-500","focus:border-primary-500","focus:z-10","sm:text-sm"],["for","confirmPassword",1,"block","text-sm","font-medium","text-gray-700"],["id","confirmPassword","name","confirmPassword","type","password","formControlName","confirmPassword",1,"mt-1","appearance-none","relative","block","w-full","px-3","py-2","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","focus:outline-none","focus:ring-primary-500","focus:border-primary-500","focus:z-10","sm:text-sm"],["class","text-center text-sm text-red-600",4,"ngIf"],["type","submit",1,"group","relative","w-full","flex","justify-center","py-2","px-4","border","border-transparent","text-sm","font-medium","rounded-md","text-white","bg-primary-600","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary-500","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["class","absolute left-0 inset-y-0 flex items-center pl-3",4,"ngIf"],[1,"mt-1","text-sm","text-red-600"],[1,"text-center","text-sm","text-red-600"],[1,"absolute","left-0","inset-y-0","flex","items-center","pl-3"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(t,e){t&1&&(a(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),s(4),n(),a(5,"p",3),s(6),a(7,"a",4),s(8),n()()(),a(9,"form",5),y("ngSubmit",function(){return e.onSubmit()}),a(10,"div",6)(11,"div")(12,"label",7),s(13),n(),u(14,"input",8),p(15,j,2,1,"p",9),n(),a(16,"div")(17,"label",10),s(18),n(),u(19,"input",11),p(20,V,2,1,"p",9),n(),a(21,"div")(22,"label",12),s(23),n(),u(24,"input",13),p(25,z,2,1,"p",9),n(),a(26,"div")(27,"label",14),s(28),n(),u(29,"input",15),p(30,B,2,1,"p",9),n()(),p(31,D,2,1,"div",16),a(32,"div")(33,"button",17),p(34,A,4,0,"span",18),s(35),n()()()()()),t&2&&(r(4),m(" ",e.i18n.t("auth.register")," "),r(2),m(" ",e.i18n.t("auth.alreadyHaveAccount")," "),r(2),m(" ",e.i18n.t("auth.login")," "),r(),l("formGroup",e.registerForm),r(4),m(" ",e.i18n.t("auth.username")," "),r(),g("border-red-500",e.getFieldError("username")),r(),l("ngIf",e.getFieldError("username")),r(3),m(" ",e.i18n.t("auth.email")," "),r(),g("border-red-500",e.getFieldError("email")),r(),l("ngIf",e.getFieldError("email")),r(3),m(" ",e.i18n.t("auth.password")," "),r(),g("border-red-500",e.getFieldError("password")),r(),l("ngIf",e.getFieldError("password")),r(3),m(" ",e.i18n.t("auth.confirmPassword")," "),r(),g("border-red-500",e.getFieldError("confirmPassword")),r(),l("ngIf",e.getFieldError("confirmPassword")),r(),l("ngIf",e.errorMessage),r(2),l("disabled",!e.registerForm.valid||e.isLoading),r(),l("ngIf",e.isLoading),r(),m(" ",e.isLoading?"...":e.i18n.t("auth.registerButton")," "))},dependencies:[w,b,N,M,C,_,R,P,k,I,S],encapsulation:2})};export{G as RegisterComponent};
