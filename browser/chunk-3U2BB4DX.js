import{a as z,c as L,d as U,e as q,f as R,g as H,h as X,k as $,l as K,m as Z,n as J,o as Q,p as Y,r as V}from"./chunk-RDPPS4E7.js";import{a as N}from"./chunk-A43KML7G.js";import{a as Se}from"./chunk-NZJYMUTK.js";import{a as ye,b as ie,c as ee,d as re}from"./chunk-LAPNKNDT.js";import{a as D}from"./chunk-DFZIMTXV.js";import{$ as h,Aa as he,Ba as A,C as _,D as G,I as s,J as n,K as i,L as f,M as v,N as x,O as c,R as F,U as ne,V as o,W as b,X as u,Y as fe,aa as S,ba as y,fa as I,ga as j,m as g,n as p,o as C,oa as B,p as O,pa as T,qa as k,ra as W,sa as P,v as r,wa as ve,x as w,xa as xe,y as E}from"./chunk-CPYGXC5A.js";import"./chunk-LJ5XHLMQ.js";import{a as _e,b as be,h as M}from"./chunk-FK42CRUA.js";function Ie(d,a){if(d&1&&(n(0,"div",10)(1,"h4",11),o(2,"Pr\xFCfungsnote"),i(),n(3,"div",12),o(4),i()()),d&2){let e=c();r(3),s("ngClass",e.getGradeColorClass((e.examGrade==null?null:e.examGrade.value)||0)),r(),u(" ",e.examGrade?e.formatGrade(e.examGrade.value):"-"," ")}}function je(d,a){if(d&1&&(n(0,"div",23)(1,"div",4),o(2),i(),n(3,"div",24),o(4),i()()),d&2){let e=a.$implicit,t=c(2);r(2),u("",e.semester,". Semester"),r(),s("ngClass",t.getGradeColorClass(e.average)),r(),u(" ",t.formatGrade(e.average)," ")}}function Ge(d,a){if(d&1&&(n(0,"div",19)(1,"h4",20),o(2,"Semesterdurchschnitte"),i(),n(3,"div",21),_(4,je,5,3,"div",22),i()()),d&2){let e=c();r(4),s("ngForOf",e.semesterAverages)}}function Ee(d,a){if(d&1&&(n(0,"span"),o(1),i()),d&2){let e=c().$implicit;r(),u(" \u2022 Gewichtung: ",e.weight)}}function Te(d,a){if(d&1&&(n(0,"span"),o(1),I(2,"date"),i()),d&2){let e=c().$implicit;r(),u(" \u2022 ",j(2,1,e.dateTaken,"dd.MM.yyyy"))}}function ke(d,a){if(d&1){let e=v();n(0,"div",27)(1,"div",28)(2,"div",29),o(3),i(),n(4,"div",4),o(5),_(6,Ee,2,1,"span",16)(7,Te,3,4,"span",16),i()(),n(8,"div",30)(9,"span",24),o(10),i(),n(11,"button",31),x("click",function(){let l=g(e).$implicit,m=c(2);return p(m.deleteGrade(l.id))}),C(),n(12,"svg",32),f(13,"path",33),i()()()()}if(d&2){let e=a.$implicit,t=c(2);r(3),b(e.name||"Einzelnote"),r(2),u(" ",e.semester,". Semester "),r(),s("ngIf",e.weight&&e.weight!==1),r(),s("ngIf",e.dateTaken),r(2),s("ngClass",t.getGradeColorClass(e.value)),r(),u(" ",t.formatGrade(e.value)," ")}}function Pe(d,a){if(d&1&&(n(0,"div")(1,"h4",20),o(2,"Einzelnoten"),i(),n(3,"div",25),_(4,ke,14,6,"div",26),i()()),d&2){let e=c();r(4),s("ngForOf",e.individualGrades)}}function Ae(d,a){if(d&1&&(n(0,"span"),o(1),I(2,"date"),i()),d&2){let e=c(2);r(),b(j(2,1,e.examGrade.dateTaken,"dd.MM.yyyy"))}}function Ve(d,a){if(d&1){let e=v();n(0,"div",34)(1,"h4",20),o(2,"Pr\xFCfungsnote"),i(),n(3,"div",35)(4,"div",28)(5,"div",29),o(6),i(),n(7,"div",4),_(8,Ae,3,4,"span",16),i()(),n(9,"div",30)(10,"span",24),o(11),i(),n(12,"button",31),x("click",function(){g(e);let l=c();return p(l.deleteGrade(l.examGrade.id))}),C(),n(13,"svg",32),f(14,"path",33),i()()()()()}if(d&2){let e=c();r(6),b(e.examGrade.name||"Pr\xFCfungsnote"),r(2),s("ngIf",e.examGrade.dateTaken),r(2),s("ngClass",e.getGradeColorClass(e.examGrade.value)),r(),u(" ",e.formatGrade(e.examGrade.value)," ")}}function De(d,a){if(d&1&&(n(0,"option",42),o(1,"Pr\xFCfungsnote"),i()),d&2){let e=c(2);s("value",e.GradeType.EXAM)}}function Ne(d,a){if(d&1){let e=v();n(0,"div")(1,"label",40),o(2,"Semester"),i(),n(3,"select",50),y("ngModelChange",function(l){g(e);let m=c(2);return S(m.semester,l)||(m.semester=l),p(l)}),n(4,"option",42),o(5,"1. Semester"),i(),n(6,"option",42),o(7,"2. Semester"),i(),n(8,"option",42),o(9,"3. Semester"),i(),n(10,"option",42),o(11,"4. Semester"),i()()()}if(d&2){let e=c(2);r(3),h("ngModel",e.semester),r(),s("value",1),r(2),s("value",2),r(2),s("value",3),r(2),s("value",4)}}function Oe(d,a){if(d&1){let e=v();n(0,"div")(1,"label",40),o(2,"Gewichtung"),i(),n(3,"input",51),y("ngModelChange",function(l){g(e);let m=c(2);return S(m.gradeWeight,l)||(m.gradeWeight=l),p(l)}),i()()}if(d&2){let e=c(2);r(3),h("ngModel",e.gradeWeight)}}function Fe(d,a){if(d&1){let e=v();n(0,"div",36)(1,"h4",37),o(2,"Note hinzuf\xFCgen"),i(),n(3,"form",38,0),x("ngSubmit",function(){g(e);let l=c();return p(l.addGrade())}),n(5,"div",39)(6,"div")(7,"label",40),o(8,"Notentyp"),i(),n(9,"select",41),y("ngModelChange",function(l){g(e);let m=c();return S(m.gradeType,l)||(m.gradeType=l),p(l)}),n(10,"option",42),o(11,"Einzelnote"),i(),_(12,De,2,1,"option",43),i()(),n(13,"div")(14,"label",40),o(15,"Note"),i(),n(16,"input",44),y("ngModelChange",function(l){g(e);let m=c();return S(m.gradeValue,l)||(m.gradeValue=l),p(l)}),i()(),n(17,"div")(18,"label",40),o(19,"Bezeichnung"),i(),n(20,"input",45),y("ngModelChange",function(l){g(e);let m=c();return S(m.gradeName,l)||(m.gradeName=l),p(l)}),i()(),n(21,"div")(22,"label",40),o(23,"Datum"),i(),n(24,"input",46),y("ngModelChange",function(l){g(e);let m=c();return S(m.dateTaken,l)||(m.dateTaken=l),p(l)}),i()(),_(25,Ne,12,5,"div",16)(26,Oe,4,1,"div",16),i(),n(27,"div",47)(28,"button",48),x("click",function(){g(e);let l=c();return p(l.closeAddForm())}),o(29," Abbrechen "),i(),n(30,"button",49),o(31," Note hinzuf\xFCgen "),i()()()()}if(d&2){let e=F(4),t=c();r(9),h("ngModel",t.gradeType),r(),s("value",t.GradeType.INDIVIDUAL),r(2),s("ngIf",t.subject.hasExam),r(4),h("ngModel",t.gradeValue),r(4),h("ngModel",t.gradeName),r(4),h("ngModel",t.dateTaken),r(),s("ngIf",t.gradeType===t.GradeType.INDIVIDUAL),r(),s("ngIf",t.gradeType===t.GradeType.INDIVIDUAL),r(4),s("disabled",!e.valid)}}var ae=class d{constructor(a,e,t){this.calculationService=a;this.supabaseService=e;this.i18n=t}subject;grades=[];gradeAdded=new G;gradeDeleted=new G;showAddForm=!1;gradeValue=4;gradeName="";gradeWeight=1;semester=1;dateTaken="";gradeType="individual";GradeType=ee;ngOnInit(){this.dateTaken=new Date().toISOString().split("T")[0]}get subjectGrades(){return this.calculationService.getGradesForSubject(this.subject.id,this.grades)}get individualGrades(){return this.subjectGrades.filter(a=>a.type==="individual")}get examGrade(){return this.subjectGrades.find(a=>a.type==="exam")||null}get experienceGrade(){return this.calculationService.calculateSubjectExperienceGrade(this.subject.id,this.grades)}get finalGrade(){return this.calculationService.calculateSubjectFinalGrade(this.subject.id,this.grades)}get semesterAverages(){return this.calculationService.getSemesterAverages(this.subject.id,this.grades)}openAddForm(){this.showAddForm=!0,this.resetForm()}closeAddForm(){this.showAddForm=!1,this.resetForm()}resetForm(){this.gradeValue=4,this.gradeName="",this.gradeWeight=1,this.semester=1,this.dateTaken=new Date().toISOString().split("T")[0],this.gradeType="individual"}addGrade(){return M(this,null,function*(){let a=this.supabaseService.getCurrentUser();if(!a){alert("Bitte melden Sie sich an, um Noten hinzuzuf\xFCgen.");return}let e=this.calculationService.validateGrade({value:this.gradeValue,subjectId:this.subject.id,type:this.gradeType,semester:this.gradeType==="individual"?this.semester:void 0,weight:this.gradeWeight});if(e.length>0){alert("Fehler: "+e.join(", "));return}try{let t={user_id:a.id,subject_id:this.subject.id,type:this.gradeType,value:this.gradeValue,date_taken:this.dateTaken};this.gradeType==="individual"?(t.name=this.gradeName||"Einzelnote",t.weight=this.gradeWeight,t.semester=this.semester):this.gradeType==="exam"&&(t.name="Pr\xFCfungsnote");let{error:l}=yield this.supabaseService.client.from("grades").insert(t);if(l){console.error("Supabase error:",l),alert(`Fehler beim Hinzuf\xFCgen der Note: ${l.message}`);return}this.gradeAdded.emit(),this.closeAddForm()}catch(t){console.error("Error adding grade:",t),alert(`Unerwarteter Fehler: ${t.message||"Unbekannter Fehler"}`)}})}deleteGrade(a){return M(this,null,function*(){if(confirm("Sind Sie sicher, dass Sie diese Note l\xF6schen m\xF6chten?"))try{let{error:e}=yield this.supabaseService.client.from("grades").delete().eq("id",a);if(e){console.error("Error deleting grade:",e),alert(`Fehler beim L\xF6schen: ${e.message}`);return}this.gradeDeleted.emit(a)}catch(e){console.error("Error deleting grade:",e),alert(`Unerwarteter Fehler: ${e.message||"Unbekannter Fehler"}`)}})}getGradesByType(a){return this.subjectGrades.filter(e=>e.type===a)}getGradesBySemester(a){return this.individualGrades.filter(e=>e.semester===a)}getGradeColorClass(a){return this.calculationService.getGradeColorClass(a)}getGradeBadgeClass(a){return this.calculationService.getGradeBadgeClass(a)}formatGrade(a){return this.calculationService.formatGrade(a)}static \u0275fac=function(e){return new(e||d)(w(N),w(A),w(D))};static \u0275cmp=E({type:d,selectors:[["app-standard-subject"]],inputs:{subject:"subject",grades:"grades"},outputs:{gradeAdded:"gradeAdded",gradeDeleted:"gradeDeleted"},decls:31,vars:12,consts:[["gradeForm","ngForm"],[1,"bg-white","rounded-lg","shadow-md","p-6","mb-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-semibold","text-gray-800"],[1,"text-sm","text-gray-600"],[1,"flex","items-center","space-x-4"],[1,"text-right"],[1,"text-2xl","font-bold",3,"ngClass"],[1,"bg-blue-500","hover:bg-blue-600","text-white","px-4","py-2","rounded-lg","transition-colors",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-6"],[1,"bg-gray-50","p-4","rounded-lg"],[1,"font-medium","text-gray-700","mb-2"],[1,"text-xl","font-semibold",3,"ngClass"],["class","bg-gray-50 p-4 rounded-lg",4,"ngIf"],[1,"text-xl","font-semibold","text-gray-600"],["class","mb-6",4,"ngIf"],[4,"ngIf"],["class","mt-4",4,"ngIf"],["class","mt-6 p-4 bg-blue-50 rounded-lg",4,"ngIf"],[1,"mb-6"],[1,"font-medium","text-gray-700","mb-3"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-3"],["class","bg-blue-50 p-3 rounded-lg text-center",4,"ngFor","ngForOf"],[1,"bg-blue-50","p-3","rounded-lg","text-center"],[1,"text-lg","font-semibold",3,"ngClass"],[1,"space-y-2"],["class","flex justify-between items-center p-3 bg-gray-50 rounded-lg",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","p-3","bg-gray-50","rounded-lg"],[1,"flex-1"],[1,"font-medium"],[1,"flex","items-center","space-x-3"],[1,"text-red-500","hover:text-red-700","p-1",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"mt-4"],[1,"flex","justify-between","items-center","p-3","bg-yellow-50","rounded-lg"],[1,"mt-6","p-4","bg-blue-50","rounded-lg"],[1,"font-medium","text-gray-700","mb-4"],[3,"ngSubmit"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["name","gradeType","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngIf"],["type","number","name","gradeValue","required","","min","1.0","max","6.0","step","0.1",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","text","name","gradeName","placeholder","z.B. Test, Lernkontrolle...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","date","name","dateTaken",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"flex","justify-end","space-x-3","mt-4"],["type","button",1,"px-4","py-2","text-gray-600","hover:text-gray-800","transition-colors",3,"click"],["type","submit",1,"px-4","py-2","bg-blue-500","hover:bg-blue-600","text-white","rounded-lg","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["name","semester","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","number","name","gradeWeight","min","0.1","max","10","step","0.1",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"]],template:function(e,t){e&1&&(n(0,"div",1)(1,"div",2)(2,"div")(3,"h3",3),o(4),i(),n(5,"p",4),o(6),i()(),n(7,"div",5)(8,"div",6)(9,"div",4),o(10,"Endnote"),i(),n(11,"div",7),o(12),i()(),n(13,"button",8),x("click",function(){return t.openAddForm()}),o(14," Note hinzuf\xFCgen "),i()()(),n(15,"div",9)(16,"div",10)(17,"h4",11),o(18,"Erfahrungsnote"),i(),n(19,"div",12),o(20),i()(),_(21,Ie,5,2,"div",13),n(22,"div",10)(23,"h4",11),o(24,"Anzahl Noten"),i(),n(25,"div",14),o(26),i()()(),_(27,Ge,5,1,"div",15)(28,Pe,5,1,"div",16)(29,Ve,15,4,"div",17)(30,Fe,32,9,"div",18),i()),e&2&&(r(4),b(t.subject.name),r(2),b(t.subject.shortName),r(5),s("ngClass",t.getGradeColorClass(t.finalGrade)),r(),u(" ",t.formatGrade(t.finalGrade)," "),r(7),s("ngClass",t.getGradeColorClass(t.experienceGrade)),r(),u(" ",t.formatGrade(t.experienceGrade)," "),r(),s("ngIf",t.subject.hasExam),r(5),u(" ",t.individualGrades.length," "),r(),s("ngIf",t.semesterAverages.length>0),r(),s("ngIf",t.individualGrades.length>0),r(),s("ngIf",t.examGrade),r(),s("ngIf",t.showAddForm))},dependencies:[P,B,T,k,V,H,K,Z,z,X,$,L,U,Y,Q,J,R,q,W],styles:[".grade-input[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:.375rem}.grade-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 2px #3b82f633}.grade-card[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;box-shadow:0 4px 6px -1px #0000001a;padding:1.5rem;margin-bottom:1.5rem}.grade-summary-item[_ngcontent-%COMP%]{background:#f9fafb;padding:1rem;border-radius:.5rem}.semester-average-card[_ngcontent-%COMP%]{background:#dbeafe;padding:.75rem;border-radius:.5rem;text-align:center}.grade-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:#f9fafb;border-radius:.5rem}.exam-grade-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:#fefce8;border-radius:.5rem}.add-form[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1rem;background:#dbeafe;border-radius:.5rem}.btn-primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;padding:.5rem 1rem;border-radius:.5rem;border:none;cursor:pointer;transition:background-color .2s}.btn-primary[_ngcontent-%COMP%]:hover{background:#2563eb}.btn-secondary[_ngcontent-%COMP%]{padding:.5rem 1rem;color:#4b5563;background:transparent;border:none;cursor:pointer;transition:color .2s}.btn-secondary[_ngcontent-%COMP%]:hover{color:#1f2937}.btn-danger[_ngcontent-%COMP%]{color:#ef4444;padding:.25rem;background:transparent;border:none;cursor:pointer}.btn-danger[_ngcontent-%COMP%]:hover{color:#dc2626}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem}@media (min-width: 768px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;margin-top:1rem}.text-grade-good[_ngcontent-%COMP%]{color:#059669}.text-grade-bad[_ngcontent-%COMP%]{color:#dc2626}.text-grade-neutral[_ngcontent-%COMP%]{color:#9ca3af}.bg-grade-good[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.bg-grade-bad[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.bg-grade-neutral[_ngcontent-%COMP%]{background:#f3f4f6;color:#4b5563}"]})};function Be(d,a){d&1&&(n(0,"div",21),o(1," Teilzeit: Chemie (1/3) + Physik (2/3) "),i())}function We(d,a){if(d&1&&(n(0,"div",22)(1,"div",23)(2,"h4",13),o(3,"Chemie (Gewichtung: 1/3)"),i(),n(4,"div",14),o(5),i(),n(6,"div",24),o(7),i()(),n(8,"div",25)(9,"h4",13),o(10,"Physik (Gewichtung: 2/3)"),i(),n(11,"div",14),o(12),i(),n(13,"div",24),o(14),i()()()),d&2){let e=c();r(4),s("ngClass",e.getGradeColorClass(e.chemieAverage)),r(),u(" ",e.formatGrade(e.chemieAverage)," "),r(2),u("",e.chemieGrades.length," Noten"),r(4),s("ngClass",e.getGradeColorClass(e.physikAverage)),r(),u(" ",e.formatGrade(e.physikAverage)," "),r(2),u("",e.physikGrades.length," Noten")}}function ze(d,a){if(d&1&&(n(0,"div",12)(1,"h4",13),o(2,"Pr\xFCfungsnote"),i(),n(3,"div",14),o(4),i()()),d&2){let e=c();r(3),s("ngClass",e.getGradeColorClass((e.examGrade==null?null:e.examGrade.value)||0)),r(),u(" ",e.examGrade?e.formatGrade(e.examGrade.value):"-"," ")}}function Le(d,a){if(d&1&&(n(0,"div",30)(1,"div",4),o(2),i(),n(3,"div",31),o(4),i()()),d&2){let e=a.$implicit,t=c(2);r(2),u("",e.semester,". Semester"),r(),s("ngClass",t.getGradeColorClass(e.average)),r(),u(" ",t.formatGrade(e.average)," ")}}function Ue(d,a){if(d&1&&(n(0,"div",26)(1,"h4",27),o(2,"Semesterdurchschnitte"),i(),n(3,"div",28),_(4,Le,5,3,"div",29),i()()),d&2){let e=c();r(4),s("ngForOf",e.semesterAverages)}}function qe(d,a){if(d&1&&(n(0,"span"),o(1),i()),d&2){let e=c().$implicit;r(),u(" \u2022 Gewichtung: ",e.weight)}}function Re(d,a){if(d&1&&(n(0,"span"),o(1),I(2,"date"),i()),d&2){let e=c().$implicit;r(),u(" \u2022 ",j(2,1,e.dateTaken,"dd.MM.yyyy"))}}function He(d,a){if(d&1){let e=v();n(0,"div",36)(1,"div",37)(2,"div",38),o(3),i(),n(4,"div",4),o(5),_(6,qe,2,1,"span",18)(7,Re,3,4,"span",18),i()(),n(8,"div",39)(9,"span",31),o(10),i(),n(11,"button",40),x("click",function(){let l=g(e).$implicit,m=c(3);return p(m.deleteGrade(l.id))}),C(),n(12,"svg",41),f(13,"path",42),i()()()()}if(d&2){let e=a.$implicit,t=c(3);r(3),b(e.name||"Einzelnote"),r(2),u(" ",e.semester,". Semester "),r(),s("ngIf",e.weight&&e.weight!==1),r(),s("ngIf",e.dateTaken),r(2),s("ngClass",t.getGradeColorClass(e.value)),r(),u(" ",t.formatGrade(e.value)," ")}}function Xe(d,a){if(d&1&&(n(0,"div",26)(1,"h4",32),f(2,"span",33),o(3," Chemie Noten "),i(),n(4,"div",34),_(5,He,14,6,"div",35),i()()),d&2){let e=c(2);r(5),s("ngForOf",e.chemieGrades)}}function $e(d,a){if(d&1&&(n(0,"span"),o(1),i()),d&2){let e=c().$implicit;r(),u(" \u2022 Gewichtung: ",e.weight)}}function Ke(d,a){if(d&1&&(n(0,"span"),o(1),I(2,"date"),i()),d&2){let e=c().$implicit;r(),u(" \u2022 ",j(2,1,e.dateTaken,"dd.MM.yyyy"))}}function Ze(d,a){if(d&1){let e=v();n(0,"div",45)(1,"div",37)(2,"div",38),o(3),i(),n(4,"div",4),o(5),_(6,$e,2,1,"span",18)(7,Ke,3,4,"span",18),i()(),n(8,"div",39)(9,"span",31),o(10),i(),n(11,"button",40),x("click",function(){let l=g(e).$implicit,m=c(3);return p(m.deleteGrade(l.id))}),C(),n(12,"svg",41),f(13,"path",42),i()()()()}if(d&2){let e=a.$implicit,t=c(3);r(3),b(e.name||"Einzelnote"),r(2),u(" ",e.semester,". Semester "),r(),s("ngIf",e.weight&&e.weight!==1),r(),s("ngIf",e.dateTaken),r(2),s("ngClass",t.getGradeColorClass(e.value)),r(),u(" ",t.formatGrade(e.value)," ")}}function Je(d,a){if(d&1&&(n(0,"div",26)(1,"h4",32),f(2,"span",43),o(3," Physik Noten "),i(),n(4,"div",34),_(5,Ze,14,6,"div",44),i()()),d&2){let e=c(2);r(5),s("ngForOf",e.physikGrades)}}function Qe(d,a){if(d&1&&(n(0,"div"),_(1,Xe,6,1,"div",17)(2,Je,6,1,"div",17),i()),d&2){let e=c();r(),s("ngIf",e.chemieGrades.length>0),r(),s("ngIf",e.physikGrades.length>0)}}function Ye(d,a){if(d&1&&(n(0,"span"),o(1),i()),d&2){let e=c().$implicit;r(),u(" \u2022 Gewichtung: ",e.weight)}}function et(d,a){if(d&1&&(n(0,"span"),o(1),I(2,"date"),i()),d&2){let e=c().$implicit;r(),u(" \u2022 ",j(2,1,e.dateTaken,"dd.MM.yyyy"))}}function tt(d,a){if(d&1){let e=v();n(0,"div",47)(1,"div",37)(2,"div",38),o(3),i(),n(4,"div",4),o(5),_(6,Ye,2,1,"span",18)(7,et,3,4,"span",18),i()(),n(8,"div",39)(9,"span",31),o(10),i(),n(11,"button",40),x("click",function(){let l=g(e).$implicit,m=c(2);return p(m.deleteGrade(l.id))}),C(),n(12,"svg",41),f(13,"path",42),i()()()()}if(d&2){let e=a.$implicit,t=c(2);r(3),b(e.name||"Einzelnote"),r(2),u(" ",e.semester,". Semester "),r(),s("ngIf",e.weight&&e.weight!==1),r(),s("ngIf",e.dateTaken),r(2),s("ngClass",t.getGradeColorClass(e.value)),r(),u(" ",t.formatGrade(e.value)," ")}}function nt(d,a){if(d&1&&(n(0,"div")(1,"h4",27),o(2,"Einzelnoten"),i(),n(3,"div",34),_(4,tt,14,6,"div",46),i()()),d&2){let e=c();r(4),s("ngForOf",e.individualGrades)}}function it(d,a){if(d&1&&(n(0,"span"),o(1),I(2,"date"),i()),d&2){let e=c(2);r(),b(j(2,1,e.examGrade.dateTaken,"dd.MM.yyyy"))}}function rt(d,a){if(d&1){let e=v();n(0,"div",48)(1,"h4",27),o(2,"Pr\xFCfungsnote"),i(),n(3,"div",49)(4,"div",37)(5,"div",38),o(6),i(),n(7,"div",4),_(8,it,3,4,"span",18),i()(),n(9,"div",39)(10,"span",31),o(11),i(),n(12,"button",40),x("click",function(){g(e);let l=c();return p(l.deleteGrade(l.examGrade.id))}),C(),n(13,"svg",41),f(14,"path",42),i()()()()()}if(d&2){let e=c();r(6),b(e.examGrade.name||"Pr\xFCfungsnote"),r(2),s("ngIf",e.examGrade.dateTaken),r(2),s("ngClass",e.getGradeColorClass(e.examGrade.value)),r(),u(" ",e.formatGrade(e.examGrade.value)," ")}}function at(d,a){if(d&1){let e=v();n(0,"div")(1,"label",54),o(2,"Fach"),i(),n(3,"select",64),y("ngModelChange",function(l){g(e);let m=c(2);return S(m.selectedSubSubject,l)||(m.selectedSubSubject=l),p(l)}),n(4,"option",65),o(5,"Chemie"),i(),n(6,"option",66),o(7,"Physik"),i()()()}if(d&2){let e=c(2);r(3),h("ngModel",e.selectedSubSubject)}}function dt(d,a){if(d&1&&(n(0,"option",56),o(1,"Pr\xFCfungsnote"),i()),d&2){let e=c(2);s("value",e.GradeType.EXAM)}}function ot(d,a){if(d&1){let e=v();n(0,"div")(1,"label",54),o(2,"Semester"),i(),n(3,"select",67),y("ngModelChange",function(l){g(e);let m=c(2);return S(m.semester,l)||(m.semester=l),p(l)}),n(4,"option",56),o(5,"1. Semester"),i(),n(6,"option",56),o(7,"2. Semester"),i(),n(8,"option",56),o(9,"3. Semester"),i(),n(10,"option",56),o(11,"4. Semester"),i()()()}if(d&2){let e=c(2);r(3),h("ngModel",e.semester),r(),s("value",1),r(2),s("value",2),r(2),s("value",3),r(2),s("value",4)}}function lt(d,a){if(d&1){let e=v();n(0,"div")(1,"label",54),o(2,"Gewichtung"),i(),n(3,"input",68),y("ngModelChange",function(l){g(e);let m=c(2);return S(m.gradeWeight,l)||(m.gradeWeight=l),p(l)}),i()()}if(d&2){let e=c(2);r(3),h("ngModel",e.gradeWeight)}}function st(d,a){if(d&1){let e=v();n(0,"div",50)(1,"h4",51),o(2,"Note hinzuf\xFCgen"),i(),n(3,"form",52,0),x("ngSubmit",function(){g(e);let l=c();return p(l.addGrade())}),n(5,"div",53),_(6,at,8,1,"div",18),n(7,"div")(8,"label",54),o(9,"Notentyp"),i(),n(10,"select",55),y("ngModelChange",function(l){g(e);let m=c();return S(m.gradeType,l)||(m.gradeType=l),p(l)}),n(11,"option",56),o(12,"Einzelnote"),i(),_(13,dt,2,1,"option",57),i()(),n(14,"div")(15,"label",54),o(16,"Note"),i(),n(17,"input",58),y("ngModelChange",function(l){g(e);let m=c();return S(m.gradeValue,l)||(m.gradeValue=l),p(l)}),i()(),n(18,"div")(19,"label",54),o(20,"Bezeichnung"),i(),n(21,"input",59),y("ngModelChange",function(l){g(e);let m=c();return S(m.gradeName,l)||(m.gradeName=l),p(l)}),i()(),n(22,"div")(23,"label",54),o(24,"Datum"),i(),n(25,"input",60),y("ngModelChange",function(l){g(e);let m=c();return S(m.dateTaken,l)||(m.dateTaken=l),p(l)}),i()(),_(26,ot,12,5,"div",18)(27,lt,4,1,"div",18),i(),n(28,"div",61)(29,"button",62),x("click",function(){g(e);let l=c();return p(l.closeAddForm())}),o(30," Abbrechen "),i(),n(31,"button",63),o(32," Note hinzuf\xFCgen "),i()()()()}if(d&2){let e=F(4),t=c();r(6),s("ngIf",t.isPartTime),r(4),h("ngModel",t.gradeType),r(),s("value",t.GradeType.INDIVIDUAL),r(2),s("ngIf",t.subject.hasExam),r(4),h("ngModel",t.gradeValue),r(4),h("ngModel",t.gradeName),r(4),h("ngModel",t.dateTaken),r(),s("ngIf",t.gradeType===t.GradeType.INDIVIDUAL),r(),s("ngIf",t.gradeType===t.GradeType.INDIVIDUAL),r(4),s("disabled",!e.valid)}}var de=class d{constructor(a,e,t){this.calculationService=a;this.supabaseService=e;this.i18n=t}subject;grades=[];studyMode="fulltime";gradeAdded=new G;gradeDeleted=new G;showAddForm=!1;gradeValue=4;gradeName="";gradeWeight=1;semester=1;dateTaken="";gradeType="individual";selectedSubSubject="chemie";GradeType=ee;StudyMode=ie;ngOnInit(){this.dateTaken=new Date().toISOString().split("T")[0]}get isPartTime(){return this.studyMode==="parttime"}get subjectGrades(){return this.calculationService.getGradesForSubject(this.subject.id,this.grades)}get chemieGrades(){return this.grades.filter(a=>a.subjectId==="chemie")}get physikGrades(){return this.grades.filter(a=>a.subjectId==="physik")}get individualGrades(){return this.subjectGrades.filter(a=>a.type==="individual")}get examGrade(){return this.subjectGrades.find(a=>a.type==="exam")||null}get experienceGrade(){return this.isPartTime?this.calculationService.calculateNaturalScienceGrade(this.grades):this.calculationService.calculateSubjectExperienceGrade(this.subject.id,this.grades)}get finalGrade(){return this.calculationService.calculateSubjectFinalGrade(this.subject.id,this.grades)}get chemieAverage(){if(this.chemieGrades.length===0)return 0;let a=this.chemieGrades.reduce((e,t)=>e+t.value,0);return Math.round(a/this.chemieGrades.length*2)/2}get physikAverage(){if(this.physikGrades.length===0)return 0;let a=this.physikGrades.reduce((e,t)=>e+t.value,0);return Math.round(a/this.physikGrades.length*2)/2}get semesterAverages(){return this.calculationService.getSemesterAverages(this.subject.id,this.grades)}openAddForm(){this.showAddForm=!0,this.resetForm()}closeAddForm(){this.showAddForm=!1,this.resetForm()}resetForm(){this.gradeValue=4,this.gradeName="",this.gradeWeight=1,this.semester=1,this.dateTaken=new Date().toISOString().split("T")[0],this.gradeType="individual",this.selectedSubSubject="chemie"}addGrade(){return M(this,null,function*(){let a=this.supabaseService.getCurrentUser();if(!a){alert("Bitte melden Sie sich an, um Noten hinzuzuf\xFCgen.");return}let e=this.isPartTime?this.selectedSubSubject:this.subject.id,t=this.calculationService.validateGrade({value:this.gradeValue,subjectId:e,type:this.gradeType,semester:this.gradeType==="individual"?this.semester:void 0,weight:this.gradeWeight});if(t.length>0){alert("Fehler: "+t.join(", "));return}try{let l={user_id:a.id,subject_id:e,type:this.gradeType,value:this.gradeValue,date_taken:this.dateTaken};this.gradeType==="individual"?(l.name=this.gradeName||"Einzelnote",l.weight=this.gradeWeight,l.semester=this.semester):this.gradeType==="exam"&&(l.name="Pr\xFCfungsnote");let{error:m}=yield this.supabaseService.client.from("grades").insert(l);if(m){console.error("Supabase error:",m),alert(`Fehler beim Hinzuf\xFCgen der Note: ${m.message}`);return}this.gradeAdded.emit(),this.closeAddForm()}catch(l){console.error("Error adding grade:",l),alert(`Unerwarteter Fehler: ${l.message||"Unbekannter Fehler"}`)}})}deleteGrade(a){return M(this,null,function*(){if(confirm("Sind Sie sicher, dass Sie diese Note l\xF6schen m\xF6chten?"))try{let{error:e}=yield this.supabaseService.client.from("grades").delete().eq("id",a);if(e){console.error("Error deleting grade:",e),alert(`Fehler beim L\xF6schen: ${e.message}`);return}this.gradeDeleted.emit(a)}catch(e){console.error("Error deleting grade:",e),alert(`Unerwarteter Fehler: ${e.message||"Unbekannter Fehler"}`)}})}getGradesBySubject(a){return this.grades.filter(e=>e.subjectId===a)}getGradesByType(a){return this.subjectGrades.filter(e=>e.type===a)}getGradesBySemester(a){return this.individualGrades.filter(e=>e.semester===a)}getGradeColorClass(a){return this.calculationService.getGradeColorClass(a)}getGradeBadgeClass(a){return this.calculationService.getGradeBadgeClass(a)}formatGrade(a){return this.calculationService.formatGrade(a)}getSubSubjectName(a){switch(a){case"chemie":return"Chemie";case"physik":return"Physik";default:return a}}static \u0275fac=function(e){return new(e||d)(w(N),w(A),w(D))};static \u0275cmp=E({type:d,selectors:[["app-natural-science-subject"]],inputs:{subject:"subject",grades:"grades",studyMode:"studyMode"},outputs:{gradeAdded:"gradeAdded",gradeDeleted:"gradeDeleted"},decls:34,vars:16,consts:[["gradeForm","ngForm"],[1,"bg-white","rounded-lg","shadow-md","p-6","mb-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-semibold","text-gray-800"],[1,"text-sm","text-gray-600"],["class","text-xs text-blue-600 mt-1",4,"ngIf"],[1,"flex","items-center","space-x-4"],[1,"text-right"],[1,"text-2xl","font-bold",3,"ngClass"],[1,"bg-blue-500","hover:bg-blue-600","text-white","px-4","py-2","rounded-lg","transition-colors",3,"click"],["class","grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-6"],[1,"bg-gray-50","p-4","rounded-lg"],[1,"font-medium","text-gray-700","mb-2"],[1,"text-xl","font-semibold",3,"ngClass"],["class","bg-gray-50 p-4 rounded-lg",4,"ngIf"],[1,"text-xl","font-semibold","text-gray-600"],["class","mb-6",4,"ngIf"],[4,"ngIf"],["class","mt-4",4,"ngIf"],["class","mt-6 p-4 bg-blue-50 rounded-lg",4,"ngIf"],[1,"text-xs","text-blue-600","mt-1"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],[1,"bg-purple-50","p-4","rounded-lg"],[1,"text-sm","text-gray-600","mt-1"],[1,"bg-green-50","p-4","rounded-lg"],[1,"mb-6"],[1,"font-medium","text-gray-700","mb-3"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-3"],["class","bg-blue-50 p-3 rounded-lg text-center",4,"ngFor","ngForOf"],[1,"bg-blue-50","p-3","rounded-lg","text-center"],[1,"text-lg","font-semibold",3,"ngClass"],[1,"font-medium","text-gray-700","mb-3","flex","items-center"],[1,"w-3","h-3","bg-purple-400","rounded-full","mr-2"],[1,"space-y-2"],["class","flex justify-between items-center p-3 bg-purple-50 rounded-lg",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","p-3","bg-purple-50","rounded-lg"],[1,"flex-1"],[1,"font-medium"],[1,"flex","items-center","space-x-3"],[1,"text-red-500","hover:text-red-700","p-1",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],[1,"w-3","h-3","bg-green-400","rounded-full","mr-2"],["class","flex justify-between items-center p-3 bg-green-50 rounded-lg",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","p-3","bg-green-50","rounded-lg"],["class","flex justify-between items-center p-3 bg-gray-50 rounded-lg",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","p-3","bg-gray-50","rounded-lg"],[1,"mt-4"],[1,"flex","justify-between","items-center","p-3","bg-yellow-50","rounded-lg"],[1,"mt-6","p-4","bg-blue-50","rounded-lg"],[1,"font-medium","text-gray-700","mb-4"],[3,"ngSubmit"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["name","gradeType","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngIf"],["type","number","name","gradeValue","required","","min","1.0","max","6.0","step","0.1",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","text","name","gradeName","placeholder","z.B. Test, Lernkontrolle...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","date","name","dateTaken",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"flex","justify-end","space-x-3","mt-4"],["type","button",1,"px-4","py-2","text-gray-600","hover:text-gray-800","transition-colors",3,"click"],["type","submit",1,"px-4","py-2","bg-blue-500","hover:bg-blue-600","text-white","rounded-lg","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["name","selectedSubSubject","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["value","chemie"],["value","physik"],["name","semester","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","number","name","gradeWeight","min","0.1","max","10","step","0.1",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"]],template:function(e,t){e&1&&(n(0,"div",1)(1,"div",2)(2,"div")(3,"h3",3),o(4),i(),n(5,"p",4),o(6),i(),_(7,Be,2,0,"div",5),i(),n(8,"div",6)(9,"div",7)(10,"div",4),o(11,"Endnote"),i(),n(12,"div",8),o(13),i()(),n(14,"button",9),x("click",function(){return t.openAddForm()}),o(15," Note hinzuf\xFCgen "),i()()(),_(16,We,15,6,"div",10),n(17,"div",11)(18,"div",12)(19,"h4",13),o(20),i(),n(21,"div",14),o(22),i()(),_(23,ze,5,2,"div",15),n(24,"div",12)(25,"h4",13),o(26,"Anzahl Noten"),i(),n(27,"div",16),o(28),i()()(),_(29,Ue,5,1,"div",17)(30,Qe,3,2,"div",18)(31,nt,5,1,"div",18)(32,rt,15,4,"div",19)(33,st,33,10,"div",20),i()),e&2&&(r(4),b(t.subject.name),r(2),b(t.subject.shortName),r(),s("ngIf",t.isPartTime),r(5),s("ngClass",t.getGradeColorClass(t.finalGrade)),r(),u(" ",t.formatGrade(t.finalGrade)," "),r(3),s("ngIf",t.isPartTime),r(4),u(" ",t.isPartTime?"Gewichteter Durchschnitt":"Erfahrungsnote"," "),r(),s("ngClass",t.getGradeColorClass(t.experienceGrade)),r(),u(" ",t.formatGrade(t.experienceGrade)," "),r(),s("ngIf",t.subject.hasExam),r(5),u(" ",t.isPartTime?t.chemieGrades.length+t.physikGrades.length:t.individualGrades.length," "),r(),s("ngIf",!t.isPartTime&&t.semesterAverages.length>0),r(),s("ngIf",t.isPartTime),r(),s("ngIf",!t.isPartTime&&t.individualGrades.length>0),r(),s("ngIf",t.examGrade),r(),s("ngIf",t.showAddForm))},dependencies:[P,B,T,k,V,H,K,Z,z,X,$,L,U,Y,Q,J,R,q,W],styles:[".natural-science-card[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;box-shadow:0 4px 6px -1px #0000001a;padding:1.5rem;margin-bottom:1.5rem}.sub-subject-card[_ngcontent-%COMP%]{padding:1rem;border-radius:.5rem}.chemie-card[_ngcontent-%COMP%]{background:#faf5ff}.physik-card[_ngcontent-%COMP%]{background:#dcfce7}.chemie-grade-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:#faf5ff;border-radius:.5rem}.physik-grade-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:#dcfce7;border-radius:.5rem}.subject-indicator[_ngcontent-%COMP%]{width:.75rem;height:.75rem;border-radius:50%;margin-right:.5rem}.chemie-indicator[_ngcontent-%COMP%]{background:#a855f7}.physik-indicator[_ngcontent-%COMP%]{background:#4ade80}.weighted-average-card[_ngcontent-%COMP%]{background:#f9fafb;padding:1rem;border-radius:.5rem}.part-time-info[_ngcontent-%COMP%]{font-size:.75rem;color:#2563eb;margin-top:.25rem}.grade-input[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:.375rem}.grade-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 2px #3b82f633}.add-form[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1rem;background:#dbeafe;border-radius:.5rem}.btn-primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;padding:.5rem 1rem;border-radius:.5rem;border:none;cursor:pointer;transition:background-color .2s}.btn-primary[_ngcontent-%COMP%]:hover{background:#2563eb}.btn-secondary[_ngcontent-%COMP%]{padding:.5rem 1rem;color:#4b5563;background:transparent;border:none;cursor:pointer;transition:color .2s}.btn-secondary[_ngcontent-%COMP%]:hover{color:#1f2937}.btn-danger[_ngcontent-%COMP%]{color:#ef4444;padding:.25rem;background:transparent;border:none;cursor:pointer}.btn-danger[_ngcontent-%COMP%]:hover{color:#dc2626}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem}@media (min-width: 768px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;margin-top:1rem}.grade-summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem;margin-bottom:1.5rem}@media (min-width: 768px){.grade-summary-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}.sub-subjects-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem;margin-bottom:1.5rem}@media (min-width: 768px){.sub-subjects-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.text-grade-good[_ngcontent-%COMP%]{color:#059669}.text-grade-bad[_ngcontent-%COMP%]{color:#dc2626}.text-grade-neutral[_ngcontent-%COMP%]{color:#9ca3af}.bg-grade-good[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.bg-grade-bad[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.bg-grade-neutral[_ngcontent-%COMP%]{background:#f3f4f6;color:#4b5563}.chemie-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#7c3aed}.physik-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#059669}.grade-item[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.grade-item[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.weight-info[_ngcontent-%COMP%]{font-size:.75rem;background:#dbeafe;color:#1e40af;padding:.25rem .5rem;border-radius:9999px}"]})};function ct(d,a){if(d&1&&(n(0,"div",33)(1,"div",4),o(2),i(),n(3,"div",34),o(4),i(),n(5,"div",35),o(6),i()()),d&2){let e=a.$implicit,t=c(2);r(2),u("",e.semester,". Semester"),r(),s("ngClass",t.getGradeColorClass(e.average)),r(),u(" ",t.formatGrade(e.average)," "),r(2),u("",e.count," Noten")}}function mt(d,a){if(d&1&&(n(0,"div",29)(1,"h4",30),f(2,"span",13),o(3," IDAF Semesterdurchschnitte "),i(),n(4,"div",31),_(5,ct,7,4,"div",32),i()()),d&2){let e=c();r(5),s("ngForOf",e.getIdafSemesterAverages())}}function ut(d,a){if(d&1&&(n(0,"span"),o(1),i()),d&2){let e=c().$implicit;r(),u(" \u2022 Gewichtung: ",e.weight)}}function gt(d,a){if(d&1&&(n(0,"span"),o(1),I(2,"date"),i()),d&2){let e=c().$implicit;r(),u(" \u2022 ",j(2,1,e.dateTaken,"dd.MM.yyyy"))}}function pt(d,a){if(d&1){let e=v();n(0,"div",38)(1,"div",39)(2,"div",40),o(3),i(),n(4,"div",4),o(5),_(6,ut,2,1,"span",41)(7,gt,3,4,"span",41),i()(),n(8,"div",42)(9,"span",34),o(10),i(),n(11,"button",43),x("click",function(){let l=g(e).$implicit,m=c(2);return p(m.deleteGrade(l.id))}),C(),n(12,"svg",44),f(13,"path",45),i()()()()}if(d&2){let e=a.$implicit,t=c(2);r(3),b(e.name||"IDAF Erfahrungsnote"),r(2),u(" ",e.semester,". Semester "),r(),s("ngIf",e.weight&&e.weight!==1),r(),s("ngIf",e.dateTaken),r(2),s("ngClass",t.getGradeColorClass(e.value)),r(),u(" ",t.formatGrade(e.value)," ")}}function _t(d,a){if(d&1&&(n(0,"div",29)(1,"h4",30),f(2,"span",13),o(3," IDAF Einzelnoten "),i(),n(4,"div",36),_(5,pt,14,6,"div",37),i()()),d&2){let e=c();r(5),s("ngForOf",e.idafGrades)}}function bt(d,a){if(d&1&&(n(0,"span"),o(1),I(2,"date"),i()),d&2){let e=c().$implicit;r(),u(" \u2022 ",j(2,1,e.dateTaken,"dd.MM.yyyy"))}}function ft(d,a){if(d&1){let e=v();n(0,"div",47)(1,"div",39)(2,"div",40),o(3),i(),n(4,"div",4),o(5," Finale Projektnote "),_(6,bt,3,4,"span",41),i()(),n(7,"div",42)(8,"span",34),o(9),i(),n(10,"button",43),x("click",function(){let l=g(e).$implicit,m=c(2);return p(m.deleteGrade(l.id))}),C(),n(11,"svg",44),f(12,"path",45),i()()()()}if(d&2){let e=a.$implicit,t=c(2);r(3),b(e.name||"IDPA Projektarbeit"),r(3),s("ngIf",e.dateTaken),r(2),s("ngClass",t.getGradeColorClass(e.value)),r(),u(" ",t.formatGrade(e.value)," ")}}function vt(d,a){if(d&1&&(n(0,"div",29)(1,"h4",30),f(2,"span",17),o(3," IDPA Projektarbeit "),i(),_(4,ft,13,4,"div",46),i()),d&2){let e=c();r(4),s("ngForOf",e.idpaGrades)}}function xt(d,a){d&1&&(n(0,"div",48),C(),n(1,"svg",49),f(2,"path",50),i(),O(),n(3,"p",51),o(4,"Noch keine IDA-Noten erfasst"),i(),n(5,"p",52),o(6,"F\xFCgen Sie IDAF- und IDPA-Noten hinzu, um die IDA-Note zu berechnen."),i()())}function ht(d,a){if(d&1){let e=v();n(0,"div")(1,"label",57),o(2,"Semester"),i(),n(3,"select",69),y("ngModelChange",function(l){g(e);let m=c(2);return S(m.semester,l)||(m.semester=l),p(l)}),n(4,"option",70),o(5,"1. Semester"),i(),n(6,"option",70),o(7,"2. Semester"),i(),n(8,"option",70),o(9,"3. Semester"),i(),n(10,"option",70),o(11,"4. Semester"),i()()()}if(d&2){let e=c(2);r(3),h("ngModel",e.semester),r(),s("value",1),r(2),s("value",2),r(2),s("value",3),r(2),s("value",4)}}function St(d,a){if(d&1){let e=v();n(0,"div")(1,"label",57),o(2,"Gewichtung"),i(),n(3,"input",71),y("ngModelChange",function(l){g(e);let m=c(2);return S(m.gradeWeight,l)||(m.gradeWeight=l),p(l)}),i()()}if(d&2){let e=c(2);r(3),h("ngModel",e.gradeWeight)}}function yt(d,a){d&1&&(n(0,"div",72)(1,"div",73),C(),n(2,"svg",74),f(3,"path",75),i(),O(),n(4,"span",76),o(5," F\xFCr IDPA ist bereits eine Note erfasst. Bitte l\xF6schen Sie die bestehende Note zuerst. "),i()()())}function Ct(d,a){if(d&1){let e=v();n(0,"div",53)(1,"h4",54),o(2,"IDA-Note hinzuf\xFCgen"),i(),n(3,"form",55,0),x("ngSubmit",function(){g(e);let l=c();return p(l.addGrade())}),n(5,"div",56)(6,"div")(7,"label",57),o(8,"Typ"),i(),n(9,"select",58),y("ngModelChange",function(l){g(e);let m=c();return S(m.selectedSubject,l)||(m.selectedSubject=l),p(l)}),n(10,"option",59),o(11,"IDAF (Erfahrungsnote)"),i(),n(12,"option",60),o(13,"IDPA (Projektarbeit)"),i()(),n(14,"div",61),o(15),i()(),n(16,"div")(17,"label",57),o(18,"Note"),i(),n(19,"input",62),y("ngModelChange",function(l){g(e);let m=c();return S(m.gradeValue,l)||(m.gradeValue=l),p(l)}),i()(),n(20,"div")(21,"label",57),o(22,"Bezeichnung"),i(),n(23,"input",63),y("ngModelChange",function(l){g(e);let m=c();return S(m.gradeName,l)||(m.gradeName=l),p(l)}),i()(),n(24,"div")(25,"label",57),o(26,"Datum"),i(),n(27,"input",64),y("ngModelChange",function(l){g(e);let m=c();return S(m.dateTaken,l)||(m.dateTaken=l),p(l)}),i()(),_(28,ht,12,5,"div",41)(29,St,4,1,"div",41),i(),_(30,yt,6,0,"div",65),n(31,"div",66)(32,"button",67),x("click",function(){g(e);let l=c();return p(l.closeAddForm())}),o(33," Abbrechen "),i(),n(34,"button",68),o(35," Note hinzuf\xFCgen "),i()()()()}if(d&2){let e=F(4),t=c();r(9),h("ngModel",t.selectedSubject),r(6),u(" ",t.getSubjectDescription(t.selectedSubject)," "),r(4),h("ngModel",t.gradeValue),r(4),h("ngModel",t.gradeName),s("placeholder",t.selectedSubject==="idaf"?"z.B. F\xE4cher\xFCbergreifende Arbeit...":"z.B. Abschlussprojekt..."),r(4),h("ngModel",t.dateTaken),r(),s("ngIf",t.selectedSubject==="idaf"),r(),s("ngIf",t.selectedSubject==="idaf"),r(),s("ngIf",t.selectedSubject==="idpa"&&t.hasIdpaGrade),r(4),s("disabled",!e.valid||t.selectedSubject==="idpa"&&t.hasIdpaGrade)}}var oe=class d{constructor(a,e,t){this.calculationService=a;this.supabaseService=e;this.i18n=t}subject;grades=[];gradeAdded=new G;gradeDeleted=new G;showAddForm=!1;gradeValue=4;gradeName="";gradeWeight=1;semester=1;dateTaken="";gradeType="individual";selectedSubject="idaf";GradeType=ee;SubjectType=re;ngOnInit(){this.dateTaken=new Date().toISOString().split("T")[0]}get idafGrades(){return this.grades.filter(a=>a.subjectId==="idaf")}get idpaGrades(){return this.grades.filter(a=>a.subjectId==="idpa")}get idafAverage(){if(this.idafGrades.length===0)return 0;let a=this.idafGrades.reduce((e,t)=>e+t.value,0);return Math.round(a/this.idafGrades.length*2)/2}get idpaGrade(){let a=this.idpaGrades.find(e=>e.type==="individual");return a?a.value:0}get idaGrade(){return this.calculationService.calculateIDAGrade(this.grades)}get hasIdafGrades(){return this.idafGrades.length>0}get hasIdpaGrade(){return this.idpaGrades.length>0}openAddForm(){this.showAddForm=!0,this.resetForm()}closeAddForm(){this.showAddForm=!1,this.resetForm()}resetForm(){this.gradeValue=4,this.gradeName="",this.gradeWeight=1,this.semester=1,this.dateTaken=new Date().toISOString().split("T")[0],this.gradeType="individual",this.selectedSubject="idaf"}addGrade(){return M(this,null,function*(){let a=this.supabaseService.getCurrentUser();if(!a){alert("Bitte melden Sie sich an, um Noten hinzuzuf\xFCgen.");return}if(this.selectedSubject==="idpa"&&this.idpaGrades.length>0){alert("F\xFCr IDPA ist nur eine Note erlaubt. Bitte l\xF6schen Sie die bestehende Note zuerst.");return}let e=this.calculationService.validateGrade({value:this.gradeValue,subjectId:this.selectedSubject,type:this.gradeType,semester:this.gradeType==="individual"?this.semester:void 0,weight:this.gradeWeight});if(e.length>0){alert("Fehler: "+e.join(", "));return}try{let t={user_id:a.id,subject_id:this.selectedSubject,type:this.gradeType,value:this.gradeValue,date_taken:this.dateTaken};this.selectedSubject==="idaf"?(t.name=this.gradeName||"IDAF Erfahrungsnote",t.weight=this.gradeWeight,t.semester=this.semester):this.selectedSubject==="idpa"&&(t.name=this.gradeName||"IDPA Projektarbeit");let{error:l}=yield this.supabaseService.client.from("grades").insert(t);if(l){console.error("Supabase error:",l),alert(`Fehler beim Hinzuf\xFCgen der Note: ${l.message}`);return}this.gradeAdded.emit(),this.closeAddForm()}catch(t){console.error("Error adding grade:",t),alert(`Unerwarteter Fehler: ${t.message||"Unbekannter Fehler"}`)}})}deleteGrade(a){return M(this,null,function*(){if(confirm("Sind Sie sicher, dass Sie diese Note l\xF6schen m\xF6chten?"))try{let{error:e}=yield this.supabaseService.client.from("grades").delete().eq("id",a);if(e){console.error("Error deleting grade:",e),alert(`Fehler beim L\xF6schen: ${e.message}`);return}this.gradeDeleted.emit(a)}catch(e){console.error("Error deleting grade:",e),alert(`Unerwarteter Fehler: ${e.message||"Unbekannter Fehler"}`)}})}getIdafSemesterAverages(){let a=[];for(let e=1;e<=4;e++){let t=this.idafGrades.filter(l=>l.semester===e);if(t.length>0){let l=t.reduce((le,te)=>le+(te.weight||1),0),m=t.reduce((le,te)=>le+te.value*(te.weight||1),0),Me=Math.round(m/l*2)/2;a.push({semester:e,average:Me,count:t.length})}}return a}getGradeColorClass(a){return this.calculationService.getGradeColorClass(a)}getGradeBadgeClass(a){return this.calculationService.getGradeBadgeClass(a)}formatGrade(a){return this.calculationService.formatGrade(a)}getSubjectDisplayName(a){switch(a){case"idaf":return"IDAF (Interdisziplin\xE4res Arbeiten in den F\xE4chern)";case"idpa":return"IDPA (Interdisziplin\xE4re Projektarbeit)";default:return a}}getSubjectDescription(a){switch(a){case"idaf":return"Erfahrungsnoten aus verschiedenen Semestern - z\xE4hlt nicht zur Promotion";case"idpa":return"Einzelne Projektarbeit - finale Note";default:return""}}static \u0275fac=function(e){return new(e||d)(w(N),w(A),w(D))};static \u0275cmp=E({type:d,selectors:[["app-ida-subject"]],inputs:{subject:"subject",grades:"grades"},outputs:{gradeAdded:"gradeAdded",gradeDeleted:"gradeDeleted"},decls:59,vars:21,consts:[["gradeForm","ngForm"],[1,"bg-white","rounded-lg","shadow-md","p-6","mb-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-semibold","text-gray-800"],[1,"text-sm","text-gray-600"],[1,"text-xs","text-purple-600","mt-1"],[1,"flex","items-center","space-x-4"],[1,"text-right"],[1,"text-2xl","font-bold",3,"ngClass"],[1,"bg-purple-500","hover:bg-purple-600","text-white","px-4","py-2","rounded-lg","transition-colors",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],[1,"bg-blue-50","p-4","rounded-lg"],[1,"font-medium","text-gray-700","mb-2","flex","items-center"],[1,"w-3","h-3","bg-blue-400","rounded-full","mr-2"],[1,"text-xl","font-semibold",3,"ngClass"],[1,"text-sm","text-gray-600","mt-1"],[1,"bg-green-50","p-4","rounded-lg"],[1,"w-3","h-3","bg-green-400","rounded-full","mr-2"],[1,"bg-purple-50","p-4","rounded-lg","mb-6"],[1,"font-medium","text-purple-700","mb-2"],[1,"text-sm","text-gray-700"],[1,"flex","justify-between","items-center"],[1,"font-medium",3,"ngClass"],[1,"my-2","border-purple-200"],[1,"flex","justify-between","items-center","font-semibold"],[1,"text-lg",3,"ngClass"],["class","mb-6",4,"ngIf"],["class","text-center py-8 text-gray-500",4,"ngIf"],["class","mt-6 p-4 bg-purple-50 rounded-lg",4,"ngIf"],[1,"mb-6"],[1,"font-medium","text-gray-700","mb-3","flex","items-center"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-3"],["class","bg-blue-50 p-3 rounded-lg text-center",4,"ngFor","ngForOf"],[1,"bg-blue-50","p-3","rounded-lg","text-center"],[1,"text-lg","font-semibold",3,"ngClass"],[1,"text-xs","text-gray-500"],[1,"space-y-2"],["class","flex justify-between items-center p-3 bg-blue-50 rounded-lg",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","p-3","bg-blue-50","rounded-lg"],[1,"flex-1"],[1,"font-medium"],[4,"ngIf"],[1,"flex","items-center","space-x-3"],[1,"text-red-500","hover:text-red-700","p-1",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],["class","flex justify-between items-center p-3 bg-green-50 rounded-lg",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","p-3","bg-green-50","rounded-lg"],[1,"text-center","py-8","text-gray-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mx-auto","mb-4","text-gray-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-lg","font-medium","mb-2"],[1,"text-sm"],[1,"mt-6","p-4","bg-purple-50","rounded-lg"],[1,"font-medium","text-gray-700","mb-4"],[3,"ngSubmit"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["name","selectedSubject","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-purple-500",3,"ngModelChange","ngModel"],["value","idaf"],["value","idpa"],[1,"text-xs","text-gray-500","mt-1"],["type","number","name","gradeValue","required","","min","1.0","max","6.0","step","0.1",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-purple-500",3,"ngModelChange","ngModel"],["type","text","name","gradeName",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-purple-500",3,"ngModelChange","ngModel","placeholder"],["type","date","name","dateTaken",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-purple-500",3,"ngModelChange","ngModel"],["class","mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",4,"ngIf"],[1,"flex","justify-end","space-x-3","mt-4"],["type","button",1,"px-4","py-2","text-gray-600","hover:text-gray-800","transition-colors",3,"click"],["type","submit",1,"px-4","py-2","bg-purple-500","hover:bg-purple-600","text-white","rounded-lg","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["name","semester","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-purple-500",3,"ngModelChange","ngModel"],[3,"value"],["type","number","name","gradeWeight","min","0.1","max","10","step","0.1",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-purple-500",3,"ngModelChange","ngModel"],[1,"mt-4","p-3","bg-yellow-50","border","border-yellow-200","rounded-lg"],[1,"flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-yellow-400","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-sm","text-yellow-800"]],template:function(e,t){e&1&&(n(0,"div",1)(1,"div",2)(2,"div")(3,"h3",3),o(4),i(),n(5,"p",4),o(6),i(),n(7,"div",5),o(8," Kombinierte IDA-Note aus IDAF und IDPA "),i()(),n(9,"div",6)(10,"div",7)(11,"div",4),o(12,"IDA-Note"),i(),n(13,"div",8),o(14),i()(),n(15,"button",9),x("click",function(){return t.openAddForm()}),o(16," Note hinzuf\xFCgen "),i()()(),n(17,"div",10)(18,"div",11)(19,"h4",12),f(20,"span",13),o(21," IDAF (Erfahrungsnote) "),i(),n(22,"div",14),o(23),i(),n(24,"div",15),o(25),i()(),n(26,"div",16)(27,"h4",12),f(28,"span",17),o(29," IDPA (Projektarbeit) "),i(),n(30,"div",14),o(31),i(),n(32,"div",15),o(33),i()()(),n(34,"div",18)(35,"h4",19),o(36,"IDA-Berechnung"),i(),n(37,"div",20)(38,"div",21)(39,"span"),o(40,"IDAF (Erfahrungsnote):"),i(),n(41,"span",22),o(42),i()(),n(43,"div",21)(44,"span"),o(45,"IDPA (Projektarbeit):"),i(),n(46,"span",22),o(47),i()(),f(48,"hr",23),n(49,"div",24)(50,"span"),o(51,"IDA-Note (Durchschnitt):"),i(),n(52,"span",25),o(53),i()()()(),_(54,mt,6,1,"div",26)(55,_t,6,1,"div",26)(56,vt,5,1,"div",26)(57,xt,7,0,"div",27)(58,Ct,36,10,"div",28),i()),e&2&&(r(4),b(t.subject.name),r(2),b(t.subject.shortName),r(7),s("ngClass",t.getGradeColorClass(t.idaGrade)),r(),u(" ",t.formatGrade(t.idaGrade)," "),r(8),s("ngClass",t.getGradeColorClass(t.idafAverage)),r(),u(" ",t.formatGrade(t.idafAverage)," "),r(2),u(" ",t.idafGrades.length," Noten \u2022 Z\xE4hlt nicht zur Promotion "),r(5),s("ngClass",t.getGradeColorClass(t.idpaGrade)),r(),u(" ",t.formatGrade(t.idpaGrade)," "),r(2),u(" ",t.hasIdpaGrade?"1 Projektnote":"Keine Note erfasst"," "),r(8),s("ngClass",t.getGradeColorClass(t.idafAverage)),r(),b(t.formatGrade(t.idafAverage)),r(4),s("ngClass",t.getGradeColorClass(t.idpaGrade)),r(),b(t.formatGrade(t.idpaGrade)),r(5),s("ngClass",t.getGradeColorClass(t.idaGrade)),r(),b(t.formatGrade(t.idaGrade)),r(),s("ngIf",t.hasIdafGrades),r(),s("ngIf",t.hasIdafGrades),r(),s("ngIf",t.hasIdpaGrade),r(),s("ngIf",!t.hasIdafGrades&&!t.hasIdpaGrade),r(),s("ngIf",t.showAddForm))},dependencies:[P,B,T,k,V,H,K,Z,z,X,$,L,U,Y,Q,J,R,q,W],styles:[".ida-card[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;box-shadow:0 4px 6px -1px #0000001a;padding:1.5rem;margin-bottom:1.5rem}.ida-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.ida-info[_ngcontent-%COMP%]{font-size:.75rem;color:#9333ea;margin-top:.25rem}.ida-summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem;margin-bottom:1.5rem}@media (min-width: 768px){.ida-summary-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.idaf-card[_ngcontent-%COMP%]{background:#dbeafe;padding:1rem;border-radius:.5rem}.idpa-card[_ngcontent-%COMP%]{background:#dcfce7;padding:1rem;border-radius:.5rem}.ida-calculation-card[_ngcontent-%COMP%]{background:#faf5ff;padding:1rem;border-radius:.5rem;margin-bottom:1.5rem}.ida-calculation-title[_ngcontent-%COMP%]{font-weight:500;color:#7c3aed;margin-bottom:.5rem}.calculation-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.calculation-result[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-weight:600}.subject-indicator[_ngcontent-%COMP%]{width:.75rem;height:.75rem;border-radius:50%;margin-right:.5rem}.idaf-indicator[_ngcontent-%COMP%]{background:#60a5fa}.idpa-indicator[_ngcontent-%COMP%]{background:#4ade80}.semester-averages-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem}@media (min-width: 768px){.semester-averages-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr)}}.semester-average-card[_ngcontent-%COMP%]{background:#dbeafe;padding:.75rem;border-radius:.5rem;text-align:center}.idaf-grade-item[_ngcontent-%COMP%], .idpa-grade-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem;border-radius:.5rem}.idaf-grade-item[_ngcontent-%COMP%]{background:#dbeafe}.idpa-grade-item[_ngcontent-%COMP%]{background:#dcfce7}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:2rem 0;color:#6b7280}.empty-state-icon[_ngcontent-%COMP%]{width:3rem;height:3rem;margin:0 auto 1rem;color:#d1d5db}.empty-state-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:500;margin-bottom:.5rem}.empty-state-description[_ngcontent-%COMP%]{font-size:.875rem}.add-form[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1rem;background:#faf5ff;border-radius:.5rem}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1rem}@media (min-width: 768px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}.form-input[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:.375rem}.form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#8b5cf6;box-shadow:0 0 0 2px #8b5cf633}.form-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.25rem}.form-help[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;margin-top:.25rem}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;margin-top:1rem}.btn-primary[_ngcontent-%COMP%]{background:#8b5cf6;color:#fff;padding:.5rem 1rem;border-radius:.5rem;border:none;cursor:pointer;transition:background-color .2s}.btn-primary[_ngcontent-%COMP%]:hover{background:#7c3aed}.btn-secondary[_ngcontent-%COMP%]{padding:.5rem 1rem;color:#4b5563;background:transparent;border:none;cursor:pointer;transition:color .2s}.btn-secondary[_ngcontent-%COMP%]:hover{color:#1f2937}.btn-danger[_ngcontent-%COMP%]{color:#ef4444;padding:.25rem;background:transparent;border:none;cursor:pointer}.btn-danger[_ngcontent-%COMP%]:hover{color:#dc2626}.text-grade-good[_ngcontent-%COMP%]{color:#059669}.text-grade-bad[_ngcontent-%COMP%]{color:#dc2626}.text-grade-neutral[_ngcontent-%COMP%]{color:#9ca3af}.bg-grade-good[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.bg-grade-bad[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.bg-grade-neutral[_ngcontent-%COMP%]{background:#f3f4f6;color:#4b5563}.idaf-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#1d4ed8}.idpa-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#059669}.ida-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#7c3aed}.grade-item[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.grade-item[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.status-complete[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46;padding:.25rem .5rem;border-radius:9999px;font-size:.75rem}.status-incomplete[_ngcontent-%COMP%]{background:#f3f4f6;color:#4b5563;padding:.25rem .5rem;border-radius:9999px;font-size:.75rem}.status-partial[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e;padding:.25rem .5rem;border-radius:9999px;font-size:.75rem}"]})};function wt(d,a){if(d&1&&(n(0,"div",4)(1,"div",5),C(),n(2,"svg",6),f(3,"path",7),i(),O(),n(4,"div")(5,"h3",8),o(6),i()()(),n(7,"div",9)(8,"a",10),C(),n(9,"svg",11),f(10,"path",12)(11,"path",13),i(),o(12),i()()()),d&2){let e=c();r(6),b(e.i18n.t("bmGrades.configureSettings")),r(6),u(" ",e.i18n.t("settings.title")," ")}}function Mt(d,a){if(d&1&&(n(0,"li"),o(1),i()),d&2){let e=a.$implicit;r(),u("\u2022 ",e)}}function It(d,a){if(d&1&&(n(0,"div",23)(1,"h4",24),o(2),i(),n(3,"ul",25),_(4,Mt,2,1,"li",26),i()()),d&2){let e=c(2);r(2),b(e.i18n.t("bmGrades.passingIssues")),r(2),s("ngForOf",e.checkPassingRequirements().issues)}}function jt(d,a){if(d&1){let e=v();n(0,"app-standard-subject",33),x("gradeAdded",function(){g(e);let l=c(3);return p(l.onGradeAdded())})("gradeDeleted",function(l){g(e);let m=c(3);return p(m.onGradeDeleted(l))}),i()}if(d&2){let e=c(3);s("subject",e.selectedSubjectForDetail)("grades",e.grades)}}function Gt(d,a){if(d&1){let e=v();n(0,"app-natural-science-subject",34),x("gradeAdded",function(){g(e);let l=c(3);return p(l.onGradeAdded())})("gradeDeleted",function(l){g(e);let m=c(3);return p(m.onGradeDeleted(l))}),i()}if(d&2){let e=c(3);s("subject",e.selectedSubjectForDetail)("grades",e.grades)("studyMode",e.studyMode)}}function Et(d,a){if(d&1){let e=v();n(0,"app-ida-subject",33),x("gradeAdded",function(){g(e);let l=c(3);return p(l.onGradeAdded())})("gradeDeleted",function(l){g(e);let m=c(3);return p(m.onGradeDeleted(l))}),i()}if(d&2){let e=c(3);s("subject",e.selectedSubjectForDetail)("grades",e.grades)}}function Tt(d,a){if(d&1){let e=v();n(0,"div",1)(1,"div",27)(2,"button",28),x("click",function(){g(e);let l=c(2);return p(l.backToOverview())}),C(),n(3,"svg",11),f(4,"path",29),i(),o(5," Zur\xFCck zur \xDCbersicht "),i(),O(),n(6,"h2",30),o(7),i()(),_(8,jt,1,2,"app-standard-subject",31)(9,Gt,1,3,"app-natural-science-subject",32)(10,Et,1,2,"app-ida-subject",31),i()}if(d&2){let e=c(2);r(7),b(e.selectedSubjectForDetail.name),r(),s("ngIf",e.getSubjectComponentType(e.selectedSubjectForDetail)==="standard"),r(),s("ngIf",e.getSubjectComponentType(e.selectedSubjectForDetail)==="natural-science"),r(),s("ngIf",e.getSubjectComponentType(e.selectedSubjectForDetail)==="ida")}}function kt(d,a){if(d&1&&(n(0,"div",59),C(),n(1,"svg",60),f(2,"path",61),i(),o(3),i()),d&2){let e=c().$implicit,t=c(3);r(3),u(" ",e.type===t.SubjectType.IDA?"IDA":e.type===t.SubjectType.IDAF?"IDAF":"IDPA"," ")}}function Pt(d,a){d&1&&(n(0,"div",62),C(),n(1,"svg",60),f(2,"path",63),i(),o(3," Naturwissenschaften "),i())}function At(d,a){if(d&1&&(n(0,"div",52)(1,"span",53),o(2),i(),n(3,"span",64),o(4,"-"),i()()),d&2){let e=c(4);r(2),u("",e.i18n.t("bmGrades.examGrade"),":")}}function Vt(d,a){if(d&1){let e=v();n(0,"div",40),x("click",function(){let l=g(e).$implicit,m=c(3);return p(m.openSubjectDetail(l))}),n(1,"div",41)(2,"div",42)(3,"div",43)(4,"h3",44),o(5),i(),n(6,"p",45),o(7),i(),_(8,kt,4,1,"div",46)(9,Pt,4,0,"div",47),i(),n(10,"div",48)(11,"div",49),o(12),i(),n(13,"div",50),o(14),i()()(),n(15,"div",51)(16,"div",52)(17,"span",53),o(18),i(),n(19,"span"),o(20),i()(),_(21,At,5,1,"div",54),n(22,"div",52)(23,"span",53),o(24),i(),n(25,"span",55),o(26),i()()(),n(27,"div",56),C(),n(28,"svg",57),f(29,"path",58),i()()()()}if(d&2){let e=a.$implicit,t=c(3);r(5),b(e.name),r(2),b(e.shortName),r(),s("ngIf",e.type===t.SubjectType.IDAF||e.type===t.SubjectType.IDPA||e.type===t.SubjectType.IDA),r(),s("ngIf",e.type===t.SubjectType.NATURAL_SCIENCE),r(2),ne(t.getGradeColorClass(t.calculateSubjectFinalGrade(e.id))),r(),u(" ",t.formatGrade(t.calculateSubjectFinalGrade(e.id))," "),r(2),b(t.i18n.t("bmGrades.finalGrade")),r(4),u("",t.i18n.t("bmGrades.experienceGrade"),":"),r(),ne(t.getGradeColorClass(t.calculateSubjectExperienceGrade(e.id))),r(),u(" ",t.formatGrade(t.calculateSubjectExperienceGrade(e.id))," "),r(),s("ngIf",e.hasExam),r(3),u("",t.i18n.t("bmGrades.grades"),":"),r(2),b(t.getSubjectGradeCount(e.id))}}function Dt(d,a){if(d&1&&(n(0,"div",35)(1,"div",36)(2,"h3",37),o(3),i()(),n(4,"div",38),_(5,Vt,30,15,"div",39),i()()),d&2){let e=c(2);r(3),b(e.i18n.t("bmGrades.subjects")),r(2),s("ngForOf",e.getSubjectsForCurrentBMType())}}function Nt(d,a){if(d&1&&(n(0,"div",1)(1,"div",14)(2,"div",15)(3,"div",16)(4,"div",17),o(5),i(),n(6,"div",18),o(7),i()(),n(8,"div",16)(9,"div",19),o(10),i(),n(11,"div",18),o(12),i()(),n(13,"div",16)(14,"div",20),o(15),i(),n(16,"div",18),o(17),i()()()(),_(18,It,5,2,"div",21)(19,Tt,11,4,"div",3)(20,Dt,6,2,"div",22),i()),d&2){let e=c();r(4),ne(e.checkPassingRequirements().passed?"text-green-600":"text-red-600"),r(),u(" ",e.checkPassingRequirements().passed?"\u2713":"\u2717"," "),r(2),b(e.i18n.t("bmGrades.passingStatus")),r(3),fe(" ",e.getSubjectsWithGradesCount(),"/",(e.bmTypeInstance==null||e.bmTypeInstance.subjects==null?null:e.bmTypeInstance.subjects.length)||0," "),r(2),b(e.i18n.t("bmGrades.subjectsWithGrades")),r(3),u(" ",e.formatGrade(e.calculateOverallGrade())," "),r(2),b(e.i18n.t("bmGrades.overallGrade")),r(),s("ngIf",!e.checkPassingRequirements().passed),r(),s("ngIf",e.currentView==="subject-detail"&&e.selectedSubjectForDetail),r(),s("ngIf",e.currentView==="overview")}}var we=class d{constructor(a,e,t,l){this.supabaseService=a;this.i18n=e;this.router=t;this.calculationService=l}bmTypeInstance=null;selectedBMType=null;studyMode="fulltime";grades=[];currentView="overview";selectedSubjectForDetail=null;availableBMTypes=[{id:"tals",name:"BM 2 Technik, Architektur, Life Sciences (TALS)"},{id:"wd-d",name:"BM 2 Dienstleistungen (WD-D)"},{id:"arte",name:"BM 2 Gestaltung & Kunst (ARTE)"},{id:"gesundheit",name:"BM 2 Gesundheit & Soziales"}];BMType=ye;StudyMode=ie;SubjectType=re;ngOnInit(){return M(this,null,function*(){yield this.loadBMSettings(),yield this.loadGrades()})}loadBMSettings(){return M(this,null,function*(){let a=this.supabaseService.getCurrentUser();if(a)try{let{data:e,error:t}=yield this.supabaseService.client.from("bm_settings").select("*").eq("user_id",a.id).single();e&&!t&&(this.selectedBMType=e.bm_type,this.studyMode=e.study_mode||"fulltime",this.selectedBMType&&this.initializeBMType(this.selectedBMType,this.studyMode))}catch(e){console.error("Error loading BM settings:",e)}})}initializeBMType(a,e){this.calculationService.initializeBMType(a,e),this.bmTypeInstance=this.calculationService.getBMType()}navigateToSubject(a){this.router.navigate(["/bm-grades/subject",a])}getSubjectsForCurrentBMType(){return this.bmTypeInstance?.subjects||[]}calculateSubjectFinalGrade(a){return this.calculationService.calculateSubjectFinalGrade(a,this.grades)}calculateSubjectExperienceGrade(a){return this.calculationService.calculateSubjectExperienceGrade(a,this.grades)}openSubjectDetail(a){this.selectedSubjectForDetail=a,this.currentView="subject-detail"}backToOverview(){this.currentView="overview",this.selectedSubjectForDetail=null}getSubjectGradeCount(a){return this.calculationService.getGradesForSubject(a,this.grades).length}loadGrades(){return M(this,null,function*(){let a=this.supabaseService.getCurrentUser();if(a)try{let{data:e,error:t}=yield this.supabaseService.client.from("grades").select("*").eq("user_id",a.id).order("created_at",{ascending:!1});e&&!t&&(this.grades=e.map(l=>be(_e({},l),{userId:l.user_id,subjectId:l.subject_id})),console.log("Loaded grades:",this.grades))}catch(e){console.error("Error loading grades:",e)}})}saveBMSettings(){return M(this,null,function*(){let a=this.supabaseService.getCurrentUser();if(!(!a||!this.selectedBMType))try{let{error:e}=yield this.supabaseService.client.from("bm_settings").upsert({user_id:a.id,bm_type:this.selectedBMType,study_mode:this.studyMode},{onConflict:"user_id"});e?console.error("Supabase error:",e):(console.log("BM settings saved successfully"),this.initializeBMType(this.selectedBMType,this.studyMode))}catch(e){console.error("Error saving BM settings:",e)}})}onGradeAdded(){this.loadGrades()}onGradeDeleted(a){this.grades=this.grades.filter(e=>e.id!==a)}getSubjectGrades(a){return this.calculationService.getGradesForSubject(a,this.grades)}calculateOverallGrade(){return this.calculationService.calculateOverallGrade(this.grades)}checkPassingRequirements(){return this.calculationService.checkPassingRequirements(this.grades)}getSubjectsWithGradesCount(){return this.bmTypeInstance?this.bmTypeInstance.subjects.filter(a=>this.grades.some(e=>e.subjectId===a.id)).length:0}getSubjectComponentType(a){return a.type==="ida"?"ida":a.type==="natural_science"?"natural-science":"standard"}getGradeColorClass(a){return this.calculationService.getGradeColorClass(a)}getGradeBadgeClass(a){return this.calculationService.getGradeBadgeClass(a)}formatGrade(a){return this.calculationService.formatGrade(a)}static \u0275fac=function(e){return new(e||d)(w(A),w(D),w(ve),w(N))};static \u0275cmp=E({type:d,selectors:[["app-bm-grades"]],decls:4,vars:4,consts:[[3,"title","subtitle"],[1,"space-y-6"],["class","bg-yellow-50 border border-yellow-200 rounded-lg p-6",4,"ngIf"],["class","space-y-6",4,"ngIf"],[1,"bg-yellow-50","border","border-yellow-200","rounded-lg","p-6"],[1,"flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-yellow-600","mr-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-lg","font-medium","text-yellow-800"],[1,"mt-4"],["routerLink","/settings",1,"inline-flex","items-center","px-4","py-2","border","border-transparent","text-sm","font-medium","rounded-md","text-yellow-800","bg-yellow-100","hover:bg-yellow-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"bg-white","rounded-lg","shadow","p-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"text-center","p-4","bg-gray-50","rounded-lg"],[1,"text-2xl","font-bold"],[1,"text-sm","text-gray-600"],[1,"text-2xl","font-bold","text-blue-600"],[1,"text-2xl","font-bold","text-purple-600"],["class","p-4 bg-red-50 border border-red-200 rounded-lg",4,"ngIf"],["class","bg-white rounded-lg shadow overflow-hidden",4,"ngIf"],[1,"p-4","bg-red-50","border","border-red-200","rounded-lg"],[1,"font-medium","text-red-800","mb-2"],[1,"text-sm","text-red-700","space-y-1"],[4,"ngFor","ngForOf"],[1,"flex","items-center","space-x-4","mb-6"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"text-2xl","font-bold","text-gray-900"],[3,"subject","grades","gradeAdded","gradeDeleted",4,"ngIf"],[3,"subject","grades","studyMode","gradeAdded","gradeDeleted",4,"ngIf"],[3,"gradeAdded","gradeDeleted","subject","grades"],[3,"gradeAdded","gradeDeleted","subject","grades","studyMode"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-900"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","gap-4","sm:gap-6","p-6"],["class","bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"bg-white","border","border-gray-200","rounded-lg","hover:shadow-md","transition-shadow","cursor-pointer",3,"click"],[1,"p-4","sm:p-6"],[1,"flex","justify-between","items-start","mb-3","sm:mb-4"],[1,"flex-1","min-w-0"],[1,"text-base","sm:text-lg","font-semibold","text-gray-900","truncate"],[1,"text-xs","sm:text-sm","text-gray-500"],["class","inline-flex items-center px-2 py-1 rounded-full text-xs bg-purple-100 text-purple-800 mt-1",4,"ngIf"],["class","inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-100 text-green-800 mt-1",4,"ngIf"],[1,"text-right","ml-3"],[1,"text-xl","sm:text-2xl","font-bold"],[1,"text-xs","text-gray-500"],[1,"space-y-1","sm:space-y-2"],[1,"flex","justify-between","text-xs","sm:text-sm"],[1,"text-gray-600"],["class","flex justify-between text-xs sm:text-sm",4,"ngIf"],[1,"text-gray-900"],[1,"flex","justify-center","mt-3","sm:hidden"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","bg-purple-100","text-purple-800","mt-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","bg-green-100","text-green-800","mt-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"],[1,"text-gray-500"]],template:function(e,t){e&1&&(n(0,"app-page-layout",0)(1,"div",1),_(2,wt,13,2,"div",2)(3,Nt,21,12,"div",3),i()()),e&2&&(s("title",t.i18n.t("bmGrades.title"))("subtitle",t.bmTypeInstance?t.bmTypeInstance.name:""),r(2),s("ngIf",!t.selectedBMType),r(),s("ngIf",t.selectedBMType))},dependencies:[P,T,k,V,he,xe,Se,ae,de,oe],styles:[".grade-input[_ngcontent-%COMP%]{display:block;width:100%;border-radius:.375rem;border:1px solid #d1d5db;box-shadow:0 1px 2px #0000000d}.grade-input[_ngcontent-%COMP%]:focus{border-color:#3b82f6;outline:none;box-shadow:0 0 0 3px #3b82f61a}.grade-positive[_ngcontent-%COMP%]{color:#059669}.grade-negative[_ngcontent-%COMP%]{color:#dc2626}.grade-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.25rem .5rem;border-radius:9999px;font-size:.75rem;font-weight:500}.grade-badge-positive[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.grade-badge-negative[_ngcontent-%COMP%]{background-color:#fee2e2;color:#991b1b}.subject-row[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.passing-status-positive[_ngcontent-%COMP%]{color:#059669;background-color:#ecfdf5;border-color:#a7f3d0}.passing-status-negative[_ngcontent-%COMP%]{color:#dc2626;background-color:#fef2f2;border-color:#fecaca}"]})};export{we as BMGradesComponent};
